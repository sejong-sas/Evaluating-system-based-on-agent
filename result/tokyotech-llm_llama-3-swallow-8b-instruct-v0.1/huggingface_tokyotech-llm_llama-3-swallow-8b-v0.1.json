{
    "model_id": "tokyotech-llm/llama-3-swallow-8b-v0.1",
    "files": [
        ".gitattributes",
        "LICENSE",
        "Notice",
        "README.md",
        "USE_POLICY.md",
        "config.json",
        "generation_config.json",
        "logo.png",
        "model-00001-of-00004.safetensors",
        "model-00002-of-00004.safetensors",
        "model-00003-of-00004.safetensors",
        "model-00004-of-00004.safetensors",
        "model.safetensors.index.json",
        "special_tokens_map.json",
        "tokenizer.json",
        "tokenizer_config.json"
    ],
    "readme": "---\nlanguage:\n  - en\n  - ja\nlibrary_name: transformers\npipeline_tag: text-generation\nlicense: llama3\nmodel_type: llama\n---\n\n# Llama3 Swallow - Built with Meta Llama 3\n\nOur Swallow model has undergone continual pre-training from the [Llama 3 family](https://huggingface.co/collections/meta-llama/meta-llama-3-66214712577ca38149ebb2b6), primarily with the addition of Japanese language data. The Instruct versions use supervised fine-tuning (SFT) and Chat Vector. Links to other models can be found in the index.\n\n\n# Model Release Updates\n\nWe are excited to share the release schedule for our latest models:\n- **July 1, 2024**: Released the [Llama-3-Swallow-8B-v0.1](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-8B-v0.1), [Llama-3-Swallow-8B-Instruct-v0.1](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-8B-Instruct-v0.1), [Llama-3-Swallow-70B-v0.1](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-70B-v0.1), and [Llama-3-Swallow-70B-Instruct-v0.1](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-70B-Instruct-v0.1).\n\n## Swallow Model Index\n\n|Model|Llama-3-Swallow|Llama3 Swallow Instruct|\n|---|---|---|\n|8B| [Link](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-8B-v0.1) | [Link](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-8B-Instruct-v0.1) |\n|70B| [Link](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-70B-v0.1) | [Link](https://huggingface.co/tokyotech-llm/Llama-3-Swallow-70B-Instruct-v0.1) |\n\n![logo](./logo.png)\n\nThis repository provides large language models developed by [Swallow-LLM](https://swallow-llm.github.io/).\nRead our [blog post](https://zenn.dev/tokyotech_lm/articles/f65989d76baf2c).\n\n## Model Details\n\n* **Model type**: Please refer to [Llama 3 MODEL_CARD](https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md) for details on the model architecture.\n* **Language(s)**: Japanese English\n* **Library**: [Megatron-LM](https://github.com/NVIDIA/Megatron-LM) \n* **Tokenizer**: Please refer to [Llama 3 blog](https://ai.meta.com/blog/meta-llama-3/) for details on the tokenizer.\n* **Contact**: swallow[at]nlp.c.titech.ac.jp \n\n## Model Performance\n\n### Japanese tasks\n\n|Model|Size|JCom.|JEMHopQA|NIILC|JSQuAD|XL-Sum|MGSM|WMT20-en-ja|WMT20-ja-en|JMMLU|JHumanEval|Ja Avg|\n|---|---|---|---|---|---|---|---|---|---|---|---|---|\n|   |   |4-shot|4-shot|4-shot|4-shot|1-shot|4-shot|4-shot|4-shot|5-shot|0-shot|   |\n|   |   |EM acc|Char-F1|Char-F1|Char-F1|ROUGE-2|EM acc|BLEU|BLEU|EM acc|pass@1|   |\n|Llama-2-7b|7B|0.2618|0.4914|0.3301|0.8001|0.1742|0.0560|0.1764|0.1742|0.2824|0.1250|0.2872|\n|Swallow-7b-hf|7B|0.4888|0.5044|**0.5925**|0.8424|0.1823|0.1240|0.2505|0.1482|0.3219|0.0183|0.3473|\n|Mistral-7B-v0.1|7B|0.7471|0.4482|0.2691|0.8588|0.2026|0.1880|0.1430|0.1738|0.4213|0.2598|0.3712|\n|Swallow-MS-7b-v0.1|7B|0.8758|**0.5153**|0.5647|0.8762|0.1993|0.2400|0.2507|0.1667|0.4527|0.2335|0.4375|\n|Qwen2-7B|7B|0.8776|0.4627|0.3766|**0.8984**|0.1716|**0.5480**|0.2080|0.1949|**0.5871**|**0.4183**|**0.4805**|\n|Meta-Llama-3-8B|8B|0.8356|0.4454|0.4002|0.8881|0.1757|0.3320|0.2199|0.2087|0.4558|0.3311|0.4292|\n|llama-3-youko-8b|8B|0.8660|0.4902|0.5155|0.8947|**0.2127**|0.2840|0.2740|0.2180|0.4493|0.2183|0.4423|\n|Llama-3-Swallow-8B-v0.1|8B|**0.8945**|0.4848|0.5640|0.8947|0.1981|0.4240|**0.2758**|**0.2223**|0.4699|0.2890|0.4717|\n\n### English tasks\n\n|Model|Size|OpenBookQA|TriviaQA|HellaSWAG|SQuAD2.0|XWINO|MMLU|GSM8K|BBH|HumanEval|En Avg|\n|---|---|---|---|---|---|---|---|---|---|---|---|\n|   |   |4-shot|4-shot|4-shot|4-shot|4-shot|5-shot|4-shot|3-shot|0-shot|   |\n|   |   |Acc|EM acc|Acc|EM acc|Acc|Acc|EM acc|CoT EM Acc|pass@1|   |\n|Llama-2-7b|7B|0.3720|0.6385|0.5826|0.2911|0.9045|0.4590|0.1266|0.3993|0.1354|0.4343|\n|Swallow-7b-hf|7B|0.3080|0.4921|0.5269|0.2608|0.8847|0.3918|0.0963|0.3531|0.0402|0.3727|\n|Mistral-7B-v0.1|7B|0.3740|0.7030|**0.6260**|0.3381|**0.9067**|0.6236|0.3851|0.5597|0.2841|0.5334|\n|Swallow-MS-7b-v0.1|7B|0.3480|0.5995|0.5798|0.3011|0.9015|0.5486|0.2669|0.4916|0.2732|0.4789|\n|Qwen2-7B|7B|0.3740|0.6105|0.6006|**0.3623**|0.8916|**0.7045**|**0.7748**|0.5325|**0.4622**|**0.5903**|\n|Meta-Llama-3-8B|8B|**0.3760**|**0.7109**|0.6124|0.3356|0.9032|0.6509|0.4936|**0.6211**|0.3793|0.5648|\n|llama-3-youko-8b|8B|0.3500|0.6252|0.5885|0.3247|0.8959|0.5993|0.3571|0.5704|0.2793|0.5100|\n|Llama-3-Swallow-8B-v0.1|8B|0.3520|0.6563|0.5901|0.3507|0.9006|0.6152|0.4875|0.5936|0.3323|0.5420|\n\n## Evaluation Benchmarks\n\n### Japanese evaluation benchmarks\n\nWe used llm-jp-eval(v1.3.0), JP Language Model Evaluation Harness(commit #9b42d41) and Code Generation LM Evaluation Harness(commit #0261c52). The details are as follows:\n\n- Multiple-choice question answering (JCommonsenseQA [Kurihara et al., 2022])\n- Open-ended question answering (JEMHopQA [Ishii et al., 2024])\n- Open-ended question answering (NIILC [関根, 2003])\n- Machine reading comprehension (JSQuAD [Kurihara et al., 2022])\n- Automatic summarization (XL-Sum [Hasan et al., 2021])\n- Machine translation (WMT2020 ja-en [Barrault et al., 2020])\n- Machine translation (WMT2020 en-ja [Barrault et al., 2020])\n- Mathematical reasoning (MGSM [Shi et al., 2023])\n- Academic exams (JMMLU [尹ら, 2024])\n- Code generation (JHumanEval [佐藤ら, 2024])\n\n### English evaluation benchmarks\n\nWe used the Language Model Evaluation Harness(v.0.4.2) and Code Generation LM Evaluation Harness(commit #0261c52). The details are as follows:\n\n- Multiple-choice question answering (OpenBookQA [Mihaylov et al., 2018])\n- Open-ended question answering (TriviaQA [Joshi et al., 2017])\n- Machine reading comprehension (SQuAD2 [Rajpurkar et al., 2018])\n- Commonsense reasoning (XWINO [Tikhonov and Ryabinin, 2021])\n- Natural language inference (HellaSwag [Zellers et al., 2019])\n- Mathematical reasoning (GSM8K [Cobbe et al., 2021])\n- Reasoning (BBH (BIG-Bench-Hard) [Suzgun et al., 2023])\n- Academic exams (MMLU [Hendrycks et al., 2021])\n- Code generation (HumanEval [Chen et al., 2021])\n\n## Training Datasets\n\n### Continual Pre-Training\nThe following datasets were used for continual pre-training.\n\n- [Algebraic Stack](https://huggingface.co/datasets/EleutherAI/proof-pile-2)\n- [Cosmopedia](https://huggingface.co/datasets/HuggingFaceTB/cosmopedia)\n- [English Wikipedia](https://dumps.wikimedia.org/other/cirrussearch)\n- [Japanese Wikipedia](https://dumps.wikimedia.org/other/cirrussearch)\n- [Laboro ParaCorpus](https://github.com/laboroai/Laboro-ParaCorpus)\n- [OpenWebMath](https://huggingface.co/datasets/EleutherAI/proof-pile-2)\n- [RefinedWeb](https://huggingface.co/datasets/tiiuae/falcon-refinedweb)\n- [Swallow Corpus](https://arxiv.org/abs/2404.17733)\n \n## Risks and Limitations\n\nThe models released here are still in the early stages of our research and development and have not been tuned to ensure outputs align with human intent and safety considerations.\n\n## Acknowledgements\n\nWe thank Meta Research for releasing Llama 3 under an open license for others to build on.\n\nOur project is supported by the [Large Generative AI Development Support Program](https://abci.ai/en/link/lfm_support_program.html) of the National Institute of Advanced Industrial Science and Technology. \n\n## License\n\n[META LLAMA 3 COMMUNITY LICENSE](https://llama.meta.com/llama3/license/)\n\n## Authors\n\nHere are the team members:\n- From [Tokyo Institute of Technology Okazaki Laboratory](https://www.nlp.c.titech.ac.jp/index.en.html), the following members:\n  - [Naoaki Okazaki](https://www.chokkan.org/index.ja.html)\n  - [Sakae Mizuki](https://s-mizuki-nlp.github.io/)\n  - [Youmi Ma](https://www.nlp.c.titech.ac.jp/member/youmi.en.html)\n  - [Koki Maeda](https://sites.google.com/view/silviase)\n  - [Kakeru Hattori](https://aya-se.vercel.app/)\n  - [Masanari Ohi](https://sites.google.com/view/masanariohi)\n  - [Taihei Shiotani](https://github.com/inatoihs)\n  - [Koshiro Saito](https://sites.google.com/view/koshiro-saito)\n- From [Tokyo Institute of Technology YOKOTA Laboratory](https://www.rio.gsic.titech.ac.jp/en/index.html), the following members:\n  - [Rio Yokota](https://twitter.com/rioyokota)\n  - [Kazuki Fujii](https://twitter.com/okoge_kaz)\n  - [Taishi Nakamura](https://twitter.com/Setuna7777_2)\n  - [Takumi Okamoto](https://www.linkedin.com/in/takumi-okamoto)\n  - [Ishida Shigeki](https://www.wantedly.com/id/reborn27)\n- From [Artificial Intelligence Research Center, AIST, Japan](https://www.airc.aist.go.jp/en/teams/), the following members:\n  - [Hiroya Takamura](https://sites.google.com/view/hjtakamura)\n\n## How to cite\n\nIf you find our work helpful, please feel free to cite us.\n\n```\n@inproceedings{Fujii:COLM2024,\n   title={Continual Pre-Training for Cross-Lingual LLM Adaptation:\nEnhancing Japanese Language Capabilities},\n   author={Kazuki Fujii and Taishi Nakamura and Mengsay Loem and Hiroki\nIida and Masanari Ohi and Kakeru Hattori and Hirai Shota and Sakae\nMizuki and Rio Yokota and Naoaki Okazaki},\n   booktitle=\"Proceedings of the First Conference on Language Modeling\",\n   series={COLM},\n   pages=\"(to appear)\",\n   year=\"2024\",\n   month=oct,\n   address={University of Pennsylvania, USA},\n}\n\n@inproceedings{Okazaki:COLM2024,\n   title={Building a Large Japanese Web Corpus for Large Language Models},\n   author={Naoaki Okazaki and Kakeru Hattori and Hirai Shota and Hiroki\nIida and Masanari Ohi and Kazuki Fujii and Taishi Nakamura and Mengsay\nLoem and Rio Yokota and Sakae Mizuki},\n   booktitle=\"Proceedings of the First Conference on Language Modeling\",\n   series={COLM},\n   pages=\"(to appear)\",\n   year=\"2024\",\n   month=oct,\n   address={University of Pennsylvania, USA},\n}\n```\n\n### Citations\n\n```tex\n@article{llama3modelcard,\n    title={Llama 3 Model Card},\n    author={AI@Meta},\n    year={2024},\n    url = {https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md}\n}\n```",
    "config": "{\n  \"_name_or_path\": \"tokyotech-llm/Llama-3-Swallow-8B-v0.1\",\n  \"architectures\": [\n    \"LlamaForCausalLM\"\n  ],\n  \"attention_bias\": false,\n  \"attention_dropout\": 0.0,\n  \"bos_token_id\": 128000,\n  \"eos_token_id\": 128001,\n  \"hidden_act\": \"silu\",\n  \"hidden_size\": 4096,\n  \"initializer_range\": 0.02,\n  \"intermediate_size\": 14336,\n  \"max_position_embeddings\": 8192,\n  \"model_type\": \"llama\",\n  \"num_attention_heads\": 32,\n  \"num_hidden_layers\": 32,\n  \"num_key_value_heads\": 8,\n  \"pretraining_tp\": 1,\n  \"rms_norm_eps\": 1e-05,\n  \"rope_scaling\": null,\n  \"rope_theta\": 500000.0,\n  \"tie_word_embeddings\": false,\n  \"torch_dtype\": \"bfloat16\",\n  \"transformers_version\": \"4.40.2\",\n  \"use_cache\": true,\n  \"vocab_size\": 128256\n}\n",
    "generation_config": "{\n  \"_from_model_config\": true,\n  \"bos_token_id\": 128000,\n  \"eos_token_id\": 128001,\n  \"transformers_version\": \"4.40.2\"\n}\n",
    "license_file": "META LLAMA 3 COMMUNITY LICENSE AGREEMENT\nMeta Llama 3 Version Release Date: April 18, 2024\n\n“Agreement” means the terms and conditions for use, reproduction, distribution and modification of the\nLlama Materials set forth herein.\n\n“Documentation” means the specifications, manuals and documentation accompanying Meta Llama 3\ndistributed by Meta at https://llama.meta.com/get-started/.\n\n“Licensee” or “you” means you, or your employer or any other person or entity (if you are entering into\nthis Agreement on such person or entity’s behalf), of the age required under applicable laws, rules or\nregulations to provide legal consent and that has legal authority to bind your employer or such other\nperson or entity if you are entering in this Agreement on their behalf.\n\n“Meta Llama 3” means the foundational large language models and software and algorithms, including\nmachine-learning model code, trained model weights, inference-enabling code, training-enabling code,\nfine-tuning enabling code and other elements of the foregoing distributed by Meta at\nhttps://llama.meta.com/llama-downloads.\n\n“Llama Materials” means, collectively, Meta’s proprietary Meta Llama 3 and Documentation (and any\nportion thereof) made available under this Agreement.\n\n“Meta” or “we” means Meta Platforms Ireland Limited (if you are located in or, if you are an entity, your\nprincipal place of business is in the EEA or Switzerland) and Meta Platforms, Inc. (if you are located\noutside of the EEA or Switzerland).\n\nBy clicking “I Accept” below or by using or distributing any portion or element of the Llama Materials,\nyou agree to be bound by this Agreement.\n\n1. License Rights and Redistribution.\n\n  a. Grant of Rights. You are granted a non-exclusive, worldwide, non-transferable and royalty-free\nlimited license under Meta’s intellectual property or other rights owned by Meta embodied in the Llama\nMaterials to use, reproduce, distribute, copy, create derivative works of, and make modifications to the\nLlama Materials.\n\n  b. Redistribution and Use.\n\n      i. If you distribute or make available the Llama Materials (or any derivative works\nthereof), or a product or service that uses any of them, including another AI model, you shall (A) provide\na copy of this Agreement with any such Llama Materials; and (B) prominently display “Built with Meta\nLlama 3” on a related website, user interface, blogpost, about page, or product documentation. If you\nuse the Llama Materials to create, train, fine tune, or otherwise improve an AI model, which is\ndistributed or made available, you shall also include “Llama 3” at the beginning of any such AI model\nname.\n\n      ii. If you receive Llama Materials, or any derivative works thereof, from a Licensee as part \nof an integrated end user product, then Section 2 of this Agreement will not apply to you.\n\n      iii. You must retain in all copies of the Llama Materials that you distribute the following\nattribution notice within a “Notice” text file distributed as a part of such copies: “Meta Llama 3 is\nlicensed under the Meta Llama 3 Community License, Copyright © Meta Platforms, Inc. All Rights\nReserved.”\n\n      iv. Your use of the Llama Materials must comply with applicable laws and regulations\n(including trade compliance laws and regulations) and adhere to the Acceptable Use Policy for the Llama\nMaterials (available at https://llama.meta.com/llama3/use-policy), which is hereby incorporated by\nreference into this Agreement.\n\n      v. You will not use the Llama Materials or any output or results of the Llama Materials to\nimprove any other large language model (excluding Meta Llama 3 or derivative works thereof).\n\n2. Additional Commercial Terms. If, on the Meta Llama 3 version release date, the monthly active users\nof the products or services made available by or for Licensee, or Licensee’s affiliates, is greater than 700\nmillion monthly active users in the preceding calendar month, you must request a license from Meta,\nwhich Meta may grant to you in its sole discretion, and you are not authorized to exercise any of the\nrights under this Agreement unless or until Meta otherwise expressly grants you such rights.\n\n3. Disclaimer of Warranty. UNLESS REQUIRED BY APPLICABLE LAW, THE LLAMA MATERIALS AND ANY\nOUTPUT AND RESULTS THEREFROM ARE PROVIDED ON AN “AS IS” BASIS, WITHOUT WARRANTIES OF\nANY KIND, AND META DISCLAIMS ALL WARRANTIES OF ANY KIND, BOTH EXPRESS AND IMPLIED,\nINCLUDING, WITHOUT LIMITATION, ANY WARRANTIES OF TITLE, NON-INFRINGEMENT,\nMERCHANTABILITY, OR FITNESS FOR A PARTICULAR PURPOSE. YOU ARE SOLELY RESPONSIBLE FOR\nDETERMINING THE APPROPRIATENESS OF USING OR REDISTRIBUTING THE LLAMA MATERIALS AND\nASSUME ANY RISKS ASSOCIATED WITH YOUR USE OF THE LLAMA MATERIALS AND ANY OUTPUT AND\nRESULTS.\n\n4. Limitation of Liability. IN NO EVENT WILL META OR ITS AFFILIATES BE LIABLE UNDER ANY THEORY OF\nLIABILITY, WHETHER IN CONTRACT, TORT, NEGLIGENCE, PRODUCTS LIABILITY, OR OTHERWISE, ARISING\nOUT OF THIS AGREEMENT, FOR ANY LOST PROFITS OR ANY INDIRECT, SPECIAL, CONSEQUENTIAL,\nINCIDENTAL, EXEMPLARY OR PUNITIVE DAMAGES, EVEN IF META OR ITS AFFILIATES HAVE BEEN ADVISED\nOF THE POSSIBILITY OF ANY OF THE FOREGOING.\n\n5. Intellectual Property.\n\n  a. No trademark licenses are granted under this Agreement, and in connection with the Llama\nMaterials, neither Meta nor Licensee may use any name or mark owned by or associated with the other\nor any of its affiliates, except as required for reasonable and customary use in describing and\nredistributing the Llama Materials or as set forth in this Section 5(a). Meta hereby grants you a license to\nuse “Llama 3” (the “Mark”) solely as required to comply with the last sentence of Section 1.b.i. You will\ncomply with Meta’s brand guidelines (currently accessible at\nhttps://about.meta.com/brand/resources/meta/company-brand/ ). All goodwill arising out of your use\nof the Mark will inure to the benefit of Meta.\n\n  b. Subject to Meta’s ownership of Llama Materials and derivatives made by or for Meta, with\nrespect to any derivative works and modifications of the Llama Materials that are made by you, as\nbetween you and Meta, you are and will be the owner of such derivative works and modifications.\n\n  c. If you institute litigation or other proceedings against Meta or any entity (including a\ncross-claim or counterclaim in a lawsuit) alleging that the Llama Materials or Meta Llama 3 outputs or\nresults, or any portion of any of the foregoing, constitutes infringement of intellectual property or other\nrights owned or licensable by you, then any licenses granted to you under this Agreement shall\nterminate as of the date such litigation or claim is filed or instituted. You will indemnify and hold\nharmless Meta from and against any claim by any third party arising out of or related to your use or\ndistribution of the Llama Materials.\n\n6. Term and Termination. The term of this Agreement will commence upon your acceptance of this\nAgreement or access to the Llama Materials and will continue in full force and effect until terminated in\naccordance with the terms and conditions herein. Meta may terminate this Agreement if you are in\nbreach of any term or condition of this Agreement. Upon termination of this Agreement, you shall delete\nand cease use of the Llama Materials. Sections 3, 4 and 7 shall survive the termination of this\nAgreement.\n\n7. Governing Law and Jurisdiction. This Agreement will be governed and construed under the laws of\nthe State of California without regard to choice of law principles, and the UN Convention on Contracts\nfor the International Sale of Goods does not apply to this Agreement. The courts of California shall have\nexclusive jurisdiction of any dispute arising out of this Agreement.",
    "py_files": {}
}